<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>YouTube Carousel - Fix Rotazione</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: black; font-family: sans-serif; }
        #player { width: 100vw; height: 100vh; }
        #progress-container { position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: rgba(255, 255, 255, 0.1); z-index: 100; }
        #progress-bar { width: 100%; height: 100%; background: #ff0000; transition: width 1s linear; }
        #debug-info { position: absolute; bottom: 10px; left: 10px; color: white; background: rgba(0,0,0,0.5); padding: 5px; font-size: 12px; z-index: 100; pointer-events: none; }
    </style>
</head>
<body>
    <div id="progress-container"><div id="progress-bar"></div></div>
    <div id="debug-info">Inizializzazione...</div>
    <div id="player"></div>

    <script>
        // --- CONFIGURAZIONE ---
        // ASSICURATI CHE QUESTI ID SIANO DIVERSI TRA LORO!
        const videoIds = [
            '91PfFoqvuUk', // Video 1
            '2RS-12YQVI4', // Video 2
            'R5i7aeV8SB8'  // Video 3
        ];
        const displayTimeSeconds = 180; // 3 minuti (180 secondi)
        
        let player;
        let currentIndex = 0;
        let secondsRemaining = displayTimeSeconds;

        // 1. Caricamento API
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(tag);

        function onYouTubeIframeAPIReady() {
            console.log("API YouTube Caricata");
            initPlayer();
        }

        function initPlayer() {
            player = new YT.Player('player', {
                videoId: videoIds[currentIndex],
                playerVars: { 
                    'autoplay': 1, 
                    'mute': 1, 
                    'controls': 0, 
                    'rel': 0, 
                    'modestbranding': 1,
                    'origin': window.location.origin 
                },
                events: {
                    'onReady': (event) => {
                        event.target.playVideo();
                        updateDebug();
                        startGlobalTimer();
                    },
                    'onError': (e) => {
                        console.error("Errore Video: " + e.data);
                        nextVideo(); // Salta al prossimo se c'Ã¨ un errore
                    }
                }
            });
        }

        function startGlobalTimer() {
            // Timer che gira ogni secondo
            setInterval(() => {
                secondsRemaining--;
                
                // Aggiorna Barra
                const percent = (secondsRemaining / displayTimeSeconds) * 100;
                document.getElementById('progress-bar').style.width = percent + "%";
                
                updateDebug();

                if (secondsRemaining <= 0) {
                    nextVideo();
                }
            }, 1000);
        }

        function nextVideo() {
            // Incrementa l'indice
            currentIndex++;
            if (currentIndex >= videoIds.length) {
                currentIndex = 0; // Torna all'inizio
            }
            
            console.log("Cambio video... Nuovo indice: " + currentIndex);
            
            // Carica il nuovo video
            player.loadVideoById({
                videoId: videoIds[currentIndex],
                suggestedQuality: 'hd1080'
            });

            // Reset del tempo
            secondsRemaining = displayTimeSeconds;
            document.getElementById('progress-bar').style.width = "100%";
        }

        function updateDebug() {
            const info = `Video attuale: ${currentIndex + 1}/${videoIds.length} | Prossimo cambio in: ${secondsRemaining}s`;
            document.getElementById('debug-info').innerText = info;
        }
    </script>
</body>
</html>

    
